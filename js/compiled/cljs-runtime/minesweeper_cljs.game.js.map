{"version":3,"sources":["minesweeper_cljs/game.cljs"],"mappings":"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","names":["minesweeper-cljs.game/get-random-mines-pos","grid-size","number-of-mines","all-pos","iter__5523__auto__","s__24107","cljs.core/LazySeq","temp__5804__auto__","cljs.core/seq","cljs.core/chunked-seq?","c__5521__auto__","size__5522__auto__","cljs.core/count","b__24109","cljs.core/chunk-buffer","i__24108","cljs.core/-nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__24106","cljs.core/chunk-rest","cljs.core/first","cljs.core/cons","cljs.core/rest","i","cljs.core.range","s__24112","b__24114","i__24113","iter__24111","s__24119","b__24121","i__24120","iter__24118","j","cljs.core.mapcat","cljs.core/identity","cljs.core/shuffle","cljs.core.take","cljs.core/set","p__24124","vec__24125","cljs.core.nth","minesweeper-cljs.game/valid-pos?","x","y","p__24137","vec__24138","minesweeper-cljs.game/get-neighbors-of-pos","p1__24136#","cljs.core.filter","minesweeper-cljs.game/get-number-of-neighbor-mines","mines","pos","cljs.core.reduce","cljs.core/+","p1__24145#","cljs.core.map","cljs.core.get","cljs.core/contains?","minesweeper-cljs.game/get-game-grid","cljs.core/vec","s__24154","b__24156","i__24155","iter__24153","s__24158","b__24160","i__24159","iter__24157","s__24175","b__24177","i__24176","iter__24174","p__24192","vec__24193","minesweeper-cljs.game/empty-pos?","grid","cljs.core._EQ_","minesweeper-cljs.game/reveal-empty-pos-and-neighbors!","revealed*","cljs.core/deref","p1__24196#","cljs.core.swap_BANG_","cljs.core.conj","seq__24201","chunk__24202","count__24203","i__24204","c__5568__auto__","cljs.core/chunk-first","cljs.core/next","neighbor","minesweeper-cljs.game/reveal-pos","revealed","cljs.core.atom","minesweeper-cljs.game/select-pos","current-state","cljs.core.println","map__24241","cljs.core/--destructure-map","flags","revealed'","flags'","clojure.set.difference","cljs.core.assoc","minesweeper-cljs.game/flag-pos","map__24247","remaining-flags","p1__24244#","cljs.core.remove","won?","minesweeper-cljs.game/get-initial-state"],"sourcesContent":["(ns minesweeper-cljs.game)\n\n(defn get-random-mines-pos\n  [grid-size number-of-mines]\n  (let [all-pos (for [i (range grid-size)]\n                  (for [j (range grid-size)]\n                    [i j]))]\n    (->> all-pos\n         (mapcat identity)\n         shuffle\n         (take number-of-mines)\n         set)))\n\n(defn valid-pos?\n  [grid-size [x y]]\n  (and (<= 0 x (dec grid-size)) (<= 0 y (dec grid-size)))) \n\n(defn get-neighbors-of-pos\n  [grid-size [x y]]\n  (->> [[(inc x) y]\n        [x (inc y)]\n        [(dec x) y]\n        [x (dec y)]\n        [(inc x) (inc y)]\n        [(dec x) (dec y)]\n        [(inc x) (dec y)]\n        [(dec x) (inc y)]]\n       (filter #(valid-pos? grid-size %))))\n\n(defn get-number-of-neighbor-mines\n  [grid-size mines pos]\n  (reduce + (map #(get {true 1 false 0} (contains? mines %))\n                 (get-neighbors-of-pos grid-size pos))))\n\n(defn get-game-grid\n  [grid-size mines]\n  (vec (for [i (range grid-size)]\n         (vec (for [j (range grid-size)]\n                (if (contains? mines [i j])\n                  :mine\n                  (get-number-of-neighbor-mines grid-size mines [i j])))))))\n\n(defn empty-pos?\n  [grid [i j]]\n  (= (nth (nth grid i) j) 0))\n\n(defn reveal-empty-pos-and-neighbors!\n  [grid revealed* pos]\n  (when (not (contains? @revealed* pos))\n    (swap! revealed* #(conj % pos))\n    (when (empty-pos? grid pos)\n      (doseq [neighbor (get-neighbors-of-pos (count grid) pos)]\n        (reveal-empty-pos-and-neighbors! grid revealed* neighbor)))))\n\n(defn reveal-pos\n  [grid revealed pos]\n  (if (not (empty-pos? grid pos))\n    (conj revealed pos) \n    ; Visit all empty neighbors and keep track of positions already visited on a state \n    ; to enhance performance\n    (let [revealed* (atom revealed)]\n      (reveal-empty-pos-and-neighbors! grid revealed* pos)\n      @revealed*)))\n\n(defn select-pos\n  [current-state pos]\n  (println \"select-pos\" current-state pos)\n  (let [{revealed :revealed\n         mines :mines\n         grid :grid\n         flags :flags} current-state\n        revealed' (reveal-pos grid revealed pos)\n        flags' (clojure.set/difference flags revealed')]\n    (assoc current-state\n           :revealed revealed'\n           :flags flags'\n           :remaining-flags (- (count mines) (count flags'))\n           :game-over (contains? mines pos))))\n\n(defn flag-pos\n  [current-state pos]\n  (println \"flag-pos\" current-state pos)\n  (let [{mines :mines\n         flags :flags\n         remaining-flags :remaining-flags} current-state] \n    (cond\n      (contains? flags pos) (assoc current-state\n                                   :flags (->> flags (remove #(= % pos)) set)\n                                   :remaining-flags (inc remaining-flags))\n      (zero? remaining-flags) current-state\n      :else (let [flags' (conj flags pos)\n                  won? (= mines flags')]\n              (assoc current-state\n                     :flags flags'\n                     :remaining-flags (dec remaining-flags)\n                     :game-over won?\n                     :won won?)))))\n\n(defn get-initial-state\n  [grid-size number-of-mines]\n  (let [mines (get-random-mines-pos grid-size number-of-mines)]\n    {:grid-size grid-size\n     :number-of-mines number-of-mines\n     :remaining-flags number-of-mines\n     :mines mines\n     :grid (get-game-grid grid-size mines)\n     :flags #{}\n     :revealed #{}\n     :game-over false\n     :won false}))"]}